# [데이터마이닝] 재난문자 유형별 분류 프로젝트
2024년 1학기 서울과학기술대학교 산업정보시스템전공 데이터마이닝 팀 프로젝트
### 팀원
- 산업정보시스템 한다은
- 산업정보시스템 이승규
- 산업정보시스템 임형빈

### 사용 언어
python

## 1. 배경 및 필요성

과도한 양의 재난문자로 인해 시민들의 피로도가 증가하고, 재난문자에 대한 신뢰도가 하락했다. 일부 시민들은 아예 재난문자 수신 기능을 해제해 놓기도 한다. 
  
## 2. 분석 목적

  수신자가 원하는 유형의 재난문자만 받아볼 수 있게 하기 위해, 재난문자를 각 유형별로 분류하는 것을 목적으로 한다. 
 
## 3. 사용 데이터 및 획득 방법

  행정안전부에서 제공하는 서울시 구청 재난문자 발송 현황 데이터를 활용했다. 공공데이터포털에서 획득했으며, 2020년 1월 ~ 2021년 1월 데이터, 2021년 2월 ~ 2021년 12월 데이터, 2022년 1월 ~ 2023년 8월 데이터 3개의 파일을 합쳐서 하나의 데이터프레임으로 만들었다.

## 4. 분석 과정
### 4.1 clustering
#### 4.1.1 DBSCAN을 통한 클러스터링 진행 
- hyperparameter: eps는 0.01 ~ 10, min_samples는 5 ~ 60까지 바꾸면서 클러스터링을 진행했다.

|클러스터명|내용|데이터 수|
|--------------|-----|--------|
|0|일반적인 정보 나타냄 ('홈페이지', '블로그', '발생', '내용', '확인', '구청', '상세' )|447|
|1|역학 조사 클러스터 ('홈페이지', '블로그', '역학', '조사', '방역', '참조', '완료', '세부')|572|
|2|코로나 관련 공지 클러스터 ('발생', '바라다', '블로그', '코로나', '내용', '상세', '참조', '안내', '강서', '강서구')|147|
|3|이동 경로 및 일정 공지 클러스터 ('공개', '동선', '예정', '사항' )|509|
|4|방역 조치 및 마스크 클러스터  ('역학', '코로나', '조사', '방역', '준수', '마스크')|187|
|5|사적 모임 자제 클러스터 ('사고', '중구청', '접종', '모임', '사적')|81|

DBSCAN은 많은 데이터들을 -1, 즉 noise로 처리함을 확인했으며,
적절치 않은 clustering 결과를 확인했다

#### 4.1.2 k-means를 통한 클러스터링 진행 
hyperparameter는 cluster 개수 -> [5,10,15,30], 중심 클러스터 선정방법(init_methods) -> ['k-means++', 'random']를 조정하여 탐색하였고, silhouette score를 참고하여 최적의 하이퍼파라미터를 선정하였다. 

그 결과 20개의 cluster를 만들고 k-means++방법으로 중심 클러스터를 찾아 보았다. 

|클러스터|내용|
|--------|----|
|Cluster 0| 진자, 코로나, 발생, 신청, 검사, 하다, 관련, 격리, 입국, 자가|
|Cluster 1| 공개, 조사, 역학, 사항, 예정, 이다, 결과, 조치, 홈페이지, 진자|
|Cluster 2| 마스크, 착용, 거리, 준수, 두기, 방역, 진자, 바라다, 발생, 공개|
|Cluster 3| 시기, 확인, 완치, 하다, 블로그, 상세, 홈페이지, 내용, 바라다, 진자|
|Cluster 4| 이용자, 알림, 검사, 시간대, 동선, 확인, 관내, 진자, 바람, 보건소|
|Cluster 5| 참고, 내용, 진자, 자세하다, 홈페이지, 바라다, 발생, 조사, 역학, 결과|
|Cluster 6| 하다, 안전, 유의, 되다, 바라다, 예상, 사고, 지역, 자제, 이용|
|Cluster 7| 운영, 시선, 검사, 진료, 보건소, 되다, 하다, 주말, 구청, 드리다|
|Cluster 8| 격리, 이송, 방역, 소독, 완료, 진자, 발생, 동선, 은평, 채널|
|Cluster 9| 사후, 구청, 공개, 동선, 참고, 역학, 홈페이지, 블로그, 발생, 진자|
|Cluster 10| 모임, 사적, 자제, 금지, 준수, 발생, 진자, 방역, 내용, 바라다|
|Cluster 11| 거주지, 완료, 사항, 방역, 참고, 자세하다, 블로그, 홈페이지, 바라다, 발생|
|Cluster 12| 안내, 참조, 블로그, 강서구, 상세, 진자, 발생, 내용, 양천구, 바라다|
|Cluster 13| 참조, 완료, 세부, 조사, 역학, 진자, 홈페이지, 내용, 바라다, 블로그|
|Cluster 14| 받다, 검사, 진료, 가깝다, 방문자, 바라다, 방문, 증상, 코로나, 보건소|
|Cluster 15| 진행중, 현재, 참고, 추가, 조사, 역학, 내용, 홈페이지, 관련, 코로나|
|Cluster 16| 확인, 상세, 구청, 코로나, 내용, 진자, 발생, 홈페이지, 바라다, 알림|
|Cluster 17| 접종, 예약, 코로나, 센터, 신청, 주민, 오늘, 방문, 되다, 하다|
|Cluster 18| 진행, 이다, 예정, 조사, 역학, 공개, 추후, 홈페이지, 완료, 발생|
|Cluster 19| 방문자, 검사, 보건소, 바라다, 받다, 코로나, 소독, 주말, 증상, 완료|

silhouette score = 0.16으로 높지 않았고, 직접 확인 하였을 때도 모든 cluster가 코로나 관련 내용으로 뭉쳐있으므로 주제에 적합한 cluster 모델은 아니라고 판단했다.


#### 4.1.3 계층적 클러스터링을 활용한 데이터 라벨링
앞의 두 클러스터링 알고리즘이 적절한 결과를 내지 못해서, Agglomerative Clustering 알고리즘을 사용했다.

덴드로그램을 그린 후 높이 150에서 군집화하여 총 19개의 클러스터로 만들었다. 그 후 유사한 클러스터끼리 병합하여 총 8개의 클러스터로 만들었다. 

- 계층적 클러스터링을 통해 데이터를 다음 8종류의 라벨로 라벨링했다.
 
|클러스터명|내용|
|-----------|--------|
|0|확진자 발생안내|
|1|기상 관련|
|2|백신, 교통, 확진자발생|
|3|전염병 임시선별소 관련|
|4|확진자 발생, 기상 관련|
|5|역학조사|
|6|전염병 검사 권장|
|7|방역 관련|

**2번, 4번 클러스터의 경우 유형이 완벽하게 나누어지지 않는 문제가 있었다.**
***
### 4.2. 재난문자 유형별 분류
#### 4.2.0. 사용 모델
 분류 모델은 SVM, XGBoost, Random Forest, Catboost를 사용했다.
 
#### 4.2.1. SVM
- 최적 hyperparameter

|C|gamma|
|---|-------|
|50|0.1|

|SVM 모델 성능| |
|--------------|-----|
|train accuracy|0.927|
|valid accuracy|0.839|

#### 4.2.2. Random Forest
- 최적 hyperparameter

|max_depth|max_features|min_samples_leaf|min_samples_split|n_estimators|
|---|-------|------|------|-----|
|20|auto|1|5|300|

|Random Forest 모델 성능| |
|--------------|-----|
|train accuracy|0.923|
|valid accuracy|0.834|

#### 4.2.3. XGBoost
- 최적 hyperparameter

|max_depth|learning_rate|colsample_bytree|subsample|n_estimators|
|---|-------|------|------|-----|
|7|0.05|1|0.6|300|

|Random Forest 모델 성능| |
|--------------|-----|
|train accuracy|0.923|
|valid accuracy|0.828|

#### 4.2.4. Catboost
- 최적 hyperparameter

|depth|learning_rate|l2_leaf_reg|iterations|
|---|-------|------|------|
|10|0.05|1|500|

|Random Forest 모델 성능| |
|--------------|-----|
|train accuracy|0.919|
|valid accuracy|0.833|

***
#### 4.2.5. 최적 모델 선정
- 선정된 최적 모델의 학습을 위해 train 데이터와 valid 데이터를 병합: X_train_final, y_train_final

- X_train_final, y_train_final으로 교차검증 진행
|model|cross-validation score(cv=5)|
|-----|-----|
|SVM|0.848|
|Random Forest|0.843|
|XGBoost|0.840|
|CatBoost|0.846|

**각각의 최적 하이퍼파라미터 모델에서의 정확도와 X_train_final, y_train_final로 진행한 교차검증 모두 SVM이 가장 좋은 성능을 보였다. &rarr; SVM을 최적 모델로 선정**

### 4.3. 재난문자 유형별 분류 - 분석 결과
- 최적 모델을 test data로 평가했다. 결과는 다음과 같다.

|cluster|precision|recall|f1-score|support|
|-----|-----|-----|-----|-----|
|0(확진자 발생)|0.91|0.95|0.93|143|
|1(기상 관련)|0.68|0.79|0.73|157|
|2(백신, 교통, 확진자발생)|0.6|0.65|0.62|77|
|3(임시선별소)|0.68|0.67|0.67|57|
|4(확진자 발생, 기상 관련)|0.82|0.81|0.82|596|
|5(역학조사)|0.97|0.95|0.96|470|
|6(전염병 검사 권장)|0.91|0.85|0.88|198|
|7(방역)|0.86|0.8|0.83|172|
|accuracy|0.849|||1870|

- 2번, 4번 클러스터는 라벨링 과정에서 깔끔하게 분리되지 않은 혼합된 클러스터이다.
- 2번과 3번 클러스터는 precision과 recall이 모두 낮아 성능 개선이 필요하다.
- 전체 클래스 중 성능이 좋지 않은 2, 3번 클래스의 데이터는 각각 384개, 262개로 다른 클래스에 비해 적은 수이다. 따라서 불균형 데이터셋이 모델의 분류 성능에 부정적인 영향을 주었을 가능성이 높다.
- 전체적인 정확도의 경우, 최적 모델로 선정된 SVM 외의 다른 모델에서도 약 0.84의 비슷한 성능을 보였다.
***

### 4.4. 한계점 및 개선 방안
#### 한계점
- 라벨링을 위한 클러스터링 과정에서 데이터가 완벽하게 분류되지 못함.
- 전염병 관련 문자의 양이 매우 많아 일반 기상 경보 관련 문자들을 잘 분류하지 못함(TF-IDF로 벡터화 시킬 때 전염병 문자 관련 단어들만 feature로 선정되는 문제 존재)

#### 개선 방안
- 서로 다른 유형의 문자에 자주 등장하는 단어가 한 문자에 동시에 존재할 수 있으므로, 문장의 맥락 파악이 필요 &rarr; **딥러닝 기반 모델의 사용**
- 데이터의 특성 상(2020년~2023년 데이터, 펜데믹) 전염병 유형 문자의 수가 다른 유형의 문자보다 매우 많음 &rarr; **데이터 수집 확대 및 텍스트 데이터 증강(SR, RI, RS, RD, Back Translation)**


